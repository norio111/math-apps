<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¾®åˆ†ãƒã‚¹ã‚¿ãƒ¼ for æ©Ÿæ¢°å­¦ç¿’</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&family=Space+Mono:wght@400;700&family=Noto+Sans+JP:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0b0b10;
    --surface: #14141c;
    --surface2: #1c1c28;
    --border: #28283c;
    --accent: #7ee8a2;
    --accent2: #f7b731;
    --accent3: #ff6b6b;
    --accent4: #74b9ff;
    --accent5: #d18cf7;
    --text: #e4e4f0;
    --text-dim: #7a7a9a;
    --text-mid: #aaaac0;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Noto Sans JP', sans-serif;
    font-weight: 300;
    min-height: 100vh;
    line-height: 1.7;
  }

  .app-shell {
    display: flex;
    min-height: 100vh;
  }

  /* ===== Sidebar ===== */
  .sidebar {
    width: 220px;
    min-width: 220px;
    background: var(--surface);
    border-right: 1px solid var(--border);
    padding: 1.5rem 0;
    position: sticky;
    top: 0;
    height: 100vh;
    overflow-y: auto;
  }

  .sidebar-logo {
    padding: 0 1.25rem 1.25rem;
    border-bottom: 1px solid var(--border);
    margin-bottom: 1rem;
  }

  .sidebar-logo h1 {
    font-family: 'Noto Serif JP', serif;
    font-size: 1rem;
    color: var(--accent);
    font-weight: 700;
  }

  .sidebar-logo p {
    font-family: 'Space Mono', monospace;
    font-size: 0.6rem;
    color: var(--text-dim);
    letter-spacing: 0.08em;
    margin-top: 0.25rem;
    text-transform: uppercase;
  }

  .sidebar-section {
    padding: 0.5rem 0.75rem;
    font-size: 0.62rem;
    font-family: 'Space Mono', monospace;
    color: var(--text-dim);
    letter-spacing: 0.12em;
    text-transform: uppercase;
    margin-top: 0.5rem;
  }

  .nav-item {
    display: flex;
    align-items: center;
    gap: 0.6rem;
    padding: 0.65rem 1.25rem;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 0.82rem;
    color: var(--text-mid);
    border-left: 3px solid transparent;
  }

  .nav-item:hover { background: var(--surface2); color: var(--text); }

  .nav-item.active {
    background: var(--surface2);
    color: var(--accent);
    border-left-color: var(--accent);
    font-weight: 500;
  }

  .nav-item .nav-icon {
    font-size: 0.9rem;
    width: 18px;
    text-align: center;
  }

  .nav-item .ml-badge {
    margin-left: auto;
    background: rgba(126,232,162,0.15);
    color: var(--accent);
    font-size: 0.55rem;
    padding: 0.1rem 0.35rem;
    border-radius: 3px;
    font-family: 'Space Mono', monospace;
    letter-spacing: 0.05em;
  }

  /* ===== Main content ===== */
  .main {
    flex: 1;
    padding: 2rem;
    overflow-x: hidden;
  }

  /* ===== Page sections ===== */
  .page { display: none; }
  .page.active { display: block; animation: fadeIn 0.3s ease; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(6px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .page-title {
    font-family: 'Noto Serif JP', serif;
    font-size: 1.6rem;
    font-weight: 700;
    color: var(--accent);
    margin-bottom: 0.4rem;
  }

  .page-subtitle {
    color: var(--text-dim);
    font-size: 0.82rem;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--border);
  }

  /* ===== Cards ===== */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 1.5rem;
  }

  .card-header {
    background: var(--surface2);
    padding: 0.9rem 1.25rem;
    border-bottom: 1px solid var(--border);
    display: flex;
    align-items: center;
    gap: 0.75rem;
  }

  .card-dot {
    width: 7px; height: 7px;
    border-radius: 50%;
  }

  .card-title {
    font-family: 'Space Mono', monospace;
    font-size: 0.68rem;
    color: var(--text-dim);
    letter-spacing: 0.12em;
    text-transform: uppercase;
  }

  .card-body { padding: 1.25rem; }

  /* ===== Two col layout ===== */
  .two-col {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1.5rem;
  }

  @media (max-width: 900px) {
    .two-col { grid-template-columns: 1fr; }
    .sidebar { display: none; }
    .mobile-nav { display: flex !important; }
  }

  /* ===== Formula blocks ===== */
  .formula-box {
    background: var(--bg);
    border: 1px solid var(--border);
    border-left: 3px solid var(--accent2);
    border-radius: 8px;
    padding: 1rem 1.25rem;
    margin: 0.75rem 0;
    font-family: 'Space Mono', monospace;
    font-size: 0.83rem;
    line-height: 2.2;
    color: var(--accent2);
  }

  .formula-box .ja {
    font-family: 'Noto Sans JP', sans-serif;
    font-size: 0.78rem;
    color: var(--text-mid);
    font-weight: 300;
    display: block;
    margin-top: -0.3rem;
    line-height: 1.6;
    padding-left: 0.5rem;
    border-left: 1px solid var(--border);
  }

  .formula-box .result {
    color: var(--accent);
    font-weight: 700;
    display: block;
    padding-top: 0.3rem;
  }

  /* ===== Step list ===== */
  .step-list { margin: 0.75rem 0; }

  .step-item {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    align-items: flex-start;
  }

  .step-num {
    background: var(--accent);
    color: var(--bg);
    font-family: 'Space Mono', monospace;
    font-size: 0.72rem;
    font-weight: 700;
    width: 24px; height: 24px;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    flex-shrink: 0;
    margin-top: 0.1rem;
  }

  .step-text { font-size: 0.85rem; line-height: 1.8; }
  .step-text strong { color: var(--accent); }
  .step-text .code { font-family: 'Space Mono', monospace; color: var(--accent2); font-size: 0.82rem; }

  /* ===== Highlight ===== */
  .hl-box {
    border-radius: 8px;
    padding: 0.9rem 1.1rem;
    margin: 0.75rem 0;
    font-size: 0.83rem;
    line-height: 1.9;
  }

  .hl-green { background: rgba(126,232,162,0.07); border: 1px solid rgba(126,232,162,0.2); }
  .hl-yellow { background: rgba(247,183,49,0.07); border: 1px solid rgba(247,183,49,0.2); }
  .hl-blue { background: rgba(116,185,255,0.07); border: 1px solid rgba(116,185,255,0.2); }
  .hl-purple { background: rgba(209,140,247,0.07); border: 1px solid rgba(209,140,247,0.2); }
  .hl-red { background: rgba(255,107,107,0.07); border: 1px solid rgba(255,107,107,0.2); }

  .hl-box .hl-title {
    font-weight: 500;
    display: block;
    margin-bottom: 0.3rem;
  }

  .hl-green .hl-title { color: var(--accent); }
  .hl-yellow .hl-title { color: var(--accent2); }
  .hl-blue .hl-title { color: var(--accent4); }
  .hl-purple .hl-title { color: var(--accent5); }
  .hl-red .hl-title { color: var(--accent3); }

  /* ===== Canvas ===== */
  canvas {
    width: 100%;
    border-radius: 8px;
    background: var(--bg);
    display: block;
  }

  /* ===== Sliders ===== */
  .ctrl-row {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-top: 0.75rem;
  }

  .ctrl-label { font-size: 0.78rem; color: var(--text-dim); white-space: nowrap; }

  .val-badge {
    font-family: 'Space Mono', monospace;
    font-size: 0.8rem;
    color: var(--accent2);
    background: var(--surface2);
    padding: 0.15rem 0.5rem;
    border-radius: 4px;
    min-width: 50px;
    text-align: center;
  }

  input[type=range] {
    flex: 1;
    -webkit-appearance: none;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    outline: none;
  }

  input[type=range]::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 15px; height: 15px;
    border-radius: 50%;
    background: var(--accent2);
    cursor: pointer;
    box-shadow: 0 0 6px rgba(247,183,49,0.5);
  }

  /* ===== Info grid ===== */
  .info-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0.75rem;
    margin-top: 0.75rem;
  }

  .info-cell {
    background: var(--surface2);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.6rem 0.75rem;
    text-align: center;
  }

  .info-cell .lbl { font-size: 0.65rem; color: var(--text-dim); font-family: 'Space Mono', monospace; text-transform: uppercase; letter-spacing: 0.07em; }
  .info-cell .val { font-family: 'Space Mono', monospace; font-size: 0.95rem; margin-top: 0.2rem; }

  /* ===== Gradient viz ===== */
  #gradCanvas { border-radius: 8px; }

  /* ===== Example grid ===== */
  .ex-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(190px, 1fr));
    gap: 0.75rem;
    margin: 0.75rem 0;
  }

  .ex-card {
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    font-family: 'Space Mono', monospace;
    font-size: 0.78rem;
  }

  .ex-card .ex-orig { color: var(--accent4); display: block; }
  .ex-card .ex-arrow { color: var(--text-dim); font-size: 0.7rem; display: block; margin: 0.2rem 0; }
  .ex-card .ex-res { color: var(--accent); display: block; }
  .ex-card .ex-ja { font-family: 'Noto Sans JP', sans-serif; color: var(--text-mid); font-size: 0.72rem; margin-top: 0.3rem; display: block; font-weight: 300; }

  /* ===== Mobile nav ===== */
  .mobile-nav {
    display: none;
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: var(--surface);
    border-top: 1px solid var(--border);
    z-index: 100;
    overflow-x: auto;
  }

  .mobile-nav button {
    flex: 1;
    min-width: 60px;
    padding: 0.6rem 0.3rem;
    background: none;
    border: none;
    color: var(--text-dim);
    font-size: 0.55rem;
    font-family: 'Noto Sans JP', sans-serif;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.2rem;
  }

  .mobile-nav button.active { color: var(--accent); }
  .mobile-nav button .m-icon { font-size: 1.1rem; }
</style>
</head>
<body>

<div class="app-shell">

  <!-- Sidebar -->
  <nav class="sidebar">
    <div class="sidebar-logo">
      <h1>å¾®åˆ†ãƒã‚¹ã‚¿ãƒ¼</h1>
      <p>for Machine Learning</p>
    </div>
    <div class="sidebar-section">åŸºç¤</div>
    <div class="nav-item active" data-page="slope" onclick="goPage('slope',this)">
      <span class="nav-icon">ğŸ“</span> å¤‰åŒ–ç‡ãƒ»å‚¾ã
    </div>
    <div class="nav-item" data-page="limit" onclick="goPage('limit',this)">
      <span class="nav-icon">âˆ</span> æ¥µé™
    </div>
    <div class="nav-item" data-page="rules" onclick="goPage('rules',this)">
      <span class="nav-icon">ğŸ“</span> å¾®åˆ†ã®ãƒ«ãƒ¼ãƒ«
    </div>
    <div class="sidebar-section">æ©Ÿæ¢°å­¦ç¿’ã¸</div>
    <div class="nav-item" data-page="partial" onclick="goPage('partial',this)">
      <span class="nav-icon">âˆ‚</span> åå¾®åˆ†
      <span class="ml-badge">ML</span>
    </div>
    <div class="nav-item" data-page="gradient" onclick="goPage('gradient',this)">
      <span class="nav-icon">â–½</span> å‹¾é…é™ä¸‹æ³•
      <span class="ml-badge">ML</span>
    </div>
    <div class="nav-item" data-page="visual" onclick="goPage('visual',this)">
      <span class="nav-icon">ğŸ“Š</span> ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–
    </div>
  </nav>

  <!-- Main -->
  <main class="main">

    <!-- =========================================
         PAGE: å¤‰åŒ–ç‡ãƒ»å‚¾ã
    ========================================= -->
    <div class="page active" id="page-slope">
      <div class="page-title">å¤‰åŒ–ç‡ã¨å‚¾ã</div>
      <div class="page-subtitle">å¾®åˆ†ã®ã€Œæ„å‘³ã€ã‚’æ—¥æœ¬èªã§ç†è§£ã™ã‚‹ â€” æ©Ÿæ¢°å­¦ç¿’ã§ã¯ã€Œæå¤±ãŒã©ã‚Œã ã‘å¤‰åŒ–ã™ã‚‹ã‹ã€ã«ç›´çµã—ã¾ã™</div>

      <div class="two-col">
        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent4)"></div>
              <span class="card-title">å¹³å‡å¤‰åŒ–ç‡ã¨ã¯</span>
            </div>
            <div class="card-body">
              <p style="font-size:0.85rem; margin-bottom:0.75rem">
                ã€Œx ãŒ a ã‹ã‚‰ b ã¾ã§å¤‰åŒ–ã—ãŸã¨ãã€f(x) ãŒã©ã‚Œãã‚‰ã„å¤‰åŒ–ã—ãŸã‹ã€ã®<strong style="color:var(--accent)">å¹³å‡ã®é€Ÿã•</strong>ã®ã“ã¨ã§ã™ã€‚
              </p>
              <div class="formula-box">
                å¹³å‡å¤‰åŒ–ç‡ = <br>
                &nbsp;&nbsp;[f(b) âˆ’ f(a)] / (b âˆ’ a)
                <span class="ja">ã€Œx ãŒã©ã‚Œã ã‘å¢—ãˆãŸã‹ã€ã«å¯¾ã—ã¦ã€Œy ãŒã©ã‚Œã ã‘å¢—ãˆãŸã‹ã€ã®å‰²åˆã€‚<br>ã‚°ãƒ©ãƒ•ã®2ç‚¹ã‚’çµã‚“ã ç›´ç·šï¼ˆå‰²ç·šï¼‰ã®å‚¾ãã¨åŒã˜ã§ã™ã€‚</span>
              </div>
              <div class="hl-box hl-blue">
                <span class="hl-title">ğŸ¥ ç†å­¦ç™‚æ³•å£«ã®ãŸã¨ãˆ</span>
                æ‚£è€…ã•ã‚“ã®æ­©è¡Œé€Ÿåº¦ãŒã€Œ10æ—¥é–“ã§ 1.2m/s â†’ 1.8m/sã€ã«æ”¹å–„ã€‚<br>
                å¹³å‡å¤‰åŒ–ç‡ = (1.8 âˆ’ 1.2) / 10 = <strong style="color:var(--accent2)">0.06 m/s/æ—¥</strong><br>
                ã€Œ1æ—¥å¹³å‡ã©ã‚Œã ã‘æ”¹å–„ã—ãŸã‹ã€ï¼ã“ã‚ŒãŒå¹³å‡å¤‰åŒ–ç‡ã§ã™ã€‚
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent)"></div>
              <span class="card-title">ç¬é–“å¤‰åŒ–ç‡ï¼ˆå¾®åˆ†ï¼‰</span>
            </div>
            <div class="card-body">
              <p style="font-size:0.85rem; margin-bottom:0.75rem">
                åŒºé–“ã‚’é™ã‚Šãªãç‹­ãã—ã¦ã€<strong style="color:var(--accent)">ã‚ã‚‹ä¸€ç‚¹ã§ã®ç¬é–“ã®å¤‰åŒ–ç‡</strong>ã‚’æ±‚ã‚ãŸã‚‚ã®ãŒå¾®åˆ†ã§ã™ã€‚
              </p>
              <div class="formula-box">
                f'(x) = lim<sub>hâ†’0</span> [f(x+h) âˆ’ f(x)] / h
                <span class="ja">hï¼ˆåŒºé–“ã®å¹…ï¼‰ã‚’é™ã‚Šãªã 0 ã«è¿‘ã¥ã‘ãŸã¨ãã®æ¥µé™å€¤ã€‚<br>ã‚°ãƒ©ãƒ•ä¸Šã®ãã®ç‚¹ã«ãŠã‘ã‚‹ã€Œæ¥ç·šã®å‚¾ãã€ã¨åŒã˜ã«ãªã‚Šã¾ã™ã€‚</span>
              </div>
              <div class="step-list">
                <div class="step-item">
                  <div class="step-num">1</div>
                  <div class="step-text">2ç‚¹é–“ã®<strong>å¹³å‡å¤‰åŒ–ç‡</strong>ã‚’è¨ˆç®—ã™ã‚‹ï¼š [f(x+h) âˆ’ f(x)] / h</div>
                </div>
                <div class="step-item">
                  <div class="step-num">2</div>
                  <div class="step-text">hã‚’<strong>ã©ã‚“ã©ã‚“0ã«è¿‘ã¥ã‘ã‚‹</strong>ï¼ˆæ¥µé™ã‚’ã¨ã‚‹ï¼‰</div>
                </div>
                <div class="step-item">
                  <div class="step-num">3</div>
                  <div class="step-text">ãã®<strong>æ¥µé™å€¤ãŒå¾®åˆ† f'(x)</strong> ï¼ ãã®ç‚¹ã§ã®æ¥ç·šã®å‚¾ã</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent2)"></div>
              <span class="card-title">æ©Ÿæ¢°å­¦ç¿’ã¨ã®é–¢ä¿‚</span>
            </div>
            <div class="card-body">
              <div class="hl-box hl-yellow">
                <span class="hl-title">ğŸ’¡ æ©Ÿæ¢°å­¦ç¿’ã§ã®å¤‰åŒ–ç‡ã®ä½¿ã„é“</span>
                æå¤±é–¢æ•°ï¼ˆLoss Functionï¼‰ãŒã©ã‚Œãã‚‰ã„æ€¥ã«å¤‰åŒ–ã—ã¦ã„ã‚‹ã‹ã‚’<br>å¾®åˆ†ã§æ±‚ã‚ã€<strong style="color:var(--accent2)">ã€Œã©ã£ã¡ã«å‹•ã‘ã°æå¤±ãŒæ¸›ã‚‹ã‹ã€</strong>ã‚’åˆ¤æ–­ã—ã¾ã™ã€‚<br>ã“ã‚ŒãŒã€Œå‹¾é…é™ä¸‹æ³•ã€ã®åŸºæœ¬åŸç†ã§ã™ã€‚
              </div>
              <div class="formula-box" style="border-left-color:var(--accent2)">
                MLã§ã‚ˆãè¦‹ã‚‹å½¢ï¼š<br>
                dL/dw = ï¼ˆæå¤± L ã®ã€é‡ã¿ w ã«å¯¾ã™ã‚‹å¾®åˆ†ï¼‰
                <span class="ja">ã€Œé‡ã¿ w ã‚’å°‘ã—å¤‰ãˆãŸã¨ãã€æå¤± L ã¯ã©ã‚Œã ã‘å¤‰ã‚ã‚‹ã‹ï¼Ÿã€<br>ã“ã®å€¤ãŒãƒ—ãƒ©ã‚¹ãªã‚‰ w ã‚’æ¸›ã‚‰ã—ã€ãƒã‚¤ãƒŠã‚¹ãªã‚‰ w ã‚’å¢—ã‚„ã™ã¨æå¤±ãŒä¸‹ãŒã‚Šã¾ã™ã€‚</span>
              </div>
              <div class="hl-box hl-green" style="margin-top:0.75rem">
                <span class="hl-title">ğŸ“Œ å‚¾ãã®ç¬¦å·ã®èª­ã¿æ–¹</span>
                <strong>æ­£ï¼ˆãƒ—ãƒ©ã‚¹ï¼‰</strong>ï¼šxã‚’å¢—ã‚„ã™ã¨yãŒå¢—ãˆã‚‹ï¼ˆå³ä¸ŠãŒã‚Šï¼‰<br>
                <strong>è² ï¼ˆãƒã‚¤ãƒŠã‚¹ï¼‰</strong>ï¼šxã‚’å¢—ã‚„ã™ã¨yãŒæ¸›ã‚‹ï¼ˆå³ä¸‹ãŒã‚Šï¼‰<br>
                <strong>ã‚¼ãƒ­</strong>ï¼šå±±ã®é ‚ä¸Šãƒ»è°·ã®åº•ï¼ˆæ¥µå¤§ãƒ»æ¥µå°ã®å€™è£œï¼‰
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent3)"></div>
              <span class="card-title">ã‚ˆãã‚ã‚‹èª¤è§£ã¨æ­£ã—ã„ç†è§£</span>
            </div>
            <div class="card-body">
              <div class="hl-box hl-red">
                <span class="hl-title">âŒ èª¤è§£ï¼šå¾®åˆ†ã¯ã€Œé›£ã—ã„è¨ˆç®—ã€</span>
                å…¬å¼ã‚’è¦šãˆã‚Œã°æ©Ÿæ¢°çš„ã«è¨ˆç®—ã§ãã¾ã™ã€‚é›£ã—ã„ã®ã¯ã€Œãªãœãã®å…¬å¼ãªã®ã‹ã€ã®å°å‡ºéƒ¨åˆ†ã€‚æ©Ÿæ¢°å­¦ç¿’ã‚’ä½¿ã†ã ã‘ãªã‚‰æ„å‘³ã®ç†è§£ãŒé‡è¦ã€‚
              </div>
              <div class="hl-box hl-green" style="margin-top:0.5rem">
                <span class="hl-title">âœ… æœ¬è³ªï¼šå¾®åˆ†ã¯ã€Œå¤‰åŒ–ã®é€Ÿã•æ¸¬å®šå™¨ã€</span>
                ã‚¹ãƒ”ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚¿ãƒ¼ãŒã€Œä»Šã®ç¬é–“ã®é€Ÿã•ã€ã‚’ç¤ºã™ã‚ˆã†ã«ã€å¾®åˆ†ã¯ã€Œãã®ç‚¹ã§ã®ã‚°ãƒ©ãƒ•ã®æ€¥ã•ã€ã‚’æ•°å€¤ã§è¡¨ã—ã¾ã™ã€‚<br>
                <strong>å¾®åˆ†å€¤ãŒå¤§ãã„</strong> = ã‚°ãƒ©ãƒ•ãŒæ€¥ = å°‘ã—xã‚’å¤‰ãˆã‚‹ã¨å¤§ããå¤‰åŒ–ã™ã‚‹
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- =========================================
         PAGE: æ¥µé™
    ========================================= -->
    <div class="page" id="page-limit">
      <div class="page-title">æ¥µé™ï¼ˆLimitï¼‰</div>
      <div class="page-subtitle">ã€Œé™ã‚Šãªãè¿‘ã¥ã‘ãŸã‚‰ã©ã†ãªã‚‹ã‹ã€â€” å¾®åˆ†ãƒ»ç©åˆ†ãƒ»æ©Ÿæ¢°å­¦ç¿’ã®åæŸåˆ¤å®šã™ã¹ã¦ã®åœŸå°</div>

      <div class="two-col">
        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent4)"></div>
              <span class="card-title">æ¥µé™ã¨ã¯ä½•ã‹</span>
            </div>
            <div class="card-body">
              <p style="font-size:0.85rem; margin-bottom:0.75rem">
                <strong style="color:var(--accent4)">æ¥µé™ï¼ˆlimitï¼‰</strong>ã¨ã¯ã€ã€Œx ã‚’ ã‚ã‚‹å€¤ a ã«é™ã‚Šãªãè¿‘ã¥ã‘ãŸã¨ãã€f(x) ã¯ã©ã‚“ãªå€¤ã«è¿‘ã¥ãã‹ã€ã¨ã„ã†æ¦‚å¿µã§ã™ã€‚ã´ã£ãŸã‚Š a ã«ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
              </p>
              <div class="formula-box">
                lim<sub>xâ†’a</sub> f(x) = L
                <span class="ja">ã€Œx ãŒ a ã«é™ã‚Šãªãè¿‘ã¥ãã¨ãã€f(x) ã¯ L ã«è¿‘ã¥ãã€<br>x=a ã§ã®å€¤ã§ã¯ãªãã€è¿‘ã¥ã„ã¦ã„ãå…ˆã®å€¤ã‚’èª¿ã¹ã¾ã™ã€‚</span>
              </div>

              <div class="step-list" style="margin-top:1rem">
                <div class="step-item">
                  <div class="step-num">ä¾‹</div>
                  <div class="step-text">
                    <span class="code">lim<sub>xâ†’2</sub> (xÂ² âˆ’ 4) / (x âˆ’ 2)</span><br>
                    x=2 ã‚’ç›´æ¥ä»£å…¥ã™ã‚‹ã¨ 0/0 ã§è¨ˆç®—ã§ããªã„â€¦
                  </div>
                </div>
                <div class="step-item">
                  <div class="step-num">1</div>
                  <div class="step-text">åˆ†å­ã‚’å› æ•°åˆ†è§£ï¼š<span class="code">xÂ² âˆ’ 4 = (x+2)(xâˆ’2)</span></div>
                </div>
                <div class="step-item">
                  <div class="step-num">2</div>
                  <div class="step-text">ç´„åˆ†ï¼š<span class="code">(x+2)(xâˆ’2) / (xâˆ’2) = x+2</span><br><span style="color:var(--text-dim); font-size:0.78rem">ï¼ˆx â‰  2 ã®ã¨ãã€‚æ¥µé™ã§ã¯ x=2 ã«ã¯ã—ãªã„ã®ã§OKï¼‰</span></div>
                </div>
                <div class="step-item">
                  <div class="step-num">3</div>
                  <div class="step-text"><span class="code">lim<sub>xâ†’2</sub> (x+2) = 4</span><br><strong>ç­”ãˆï¼š4</strong></div>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent)"></div>
              <span class="card-title">å¾®åˆ†ã®å®šç¾©å¼ã¨ã®é–¢ä¿‚</span>
            </div>
            <div class="card-body">
              <div class="formula-box">
                f'(x) = lim<sub>hâ†’0</sub> [f(x+h) âˆ’ f(x)] / h
                <span class="ja">hâ†’0 ã¯ã€Œh ã‚’é™ã‚Šãªã 0 ã«è¿‘ã¥ã‘ã‚‹ã€ã¨ã„ã†æ¥µé™ã€‚<br>h=0 ã«ã™ã‚‹ã¨ 0/0 ã«ãªã‚‹ã®ã§ã€æ¥µé™ã§å®šç¾©ã—ã¾ã™ã€‚</span>
              </div>
              <div class="hl-box hl-green">
                <span class="hl-title">âœ… ã¤ã¾ã‚Šï¼šå¾®åˆ†ã®è¨ˆç®— = æ¥µé™ã®è¨ˆç®—</span>
                ã¹ãä¹—å‰‡ãªã©ã®å…¬å¼ã¯ã€ã“ã® lim ã®è¨ˆç®—ã‚’å‰ã‚‚ã£ã¦ã‚„ã£ã¦ãŠã„ãŸã€Œæ™‚çŸ­ãƒ¬ã‚·ãƒ”ã€ã§ã™ã€‚æ¯å› lim ã‚’è¨ˆç®—ã—ãªãã¦ã„ã„ã‚ˆã†ã«å…¬å¼ã‚’ä½¿ã„ã¾ã™ã€‚
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent5)"></div>
              <span class="card-title">æ©Ÿæ¢°å­¦ç¿’ã§ã®ã€ŒåæŸã€ã¨ã®é–¢ä¿‚</span>
            </div>
            <div class="card-body">
              <div class="hl-box hl-purple">
                <span class="hl-title">ğŸ¤– MLã§ã®æ¥µé™ã®å‡ºç•ª</span>
                å­¦ç¿’ãƒ«ãƒ¼ãƒ—ã§ã€Œæå¤±ãŒã‚ã‚‹å€¤ã«åæŸï¼ˆlimitï¼‰ã—ãŸã€ã¨ã„ã†åˆ¤å®šã«ä½¿ã„ã¾ã™ã€‚ç†è«–çš„ã«ã¯<br>ã€Œå­¦ç¿’å›æ•° n â†’ âˆ ã®ã¨ãæå¤± L(n) â†’ æœ€å°å€¤ L*ã€<br>ã¨ã„ã†æ¥µé™ã®å­˜åœ¨ã‚’è­°è«–ã—ã¦ã„ã¾ã™ã€‚
              </div>
              <div class="formula-box" style="border-left-color:var(--accent5)">
                é‡è¦ãªæ¥µé™ï¼ˆã‚ˆãå‡ºã‚‹ï¼‰ï¼š<br><br>
                lim<sub>xâ†’0</sub> sin(x)/x = 1
                <span class="ja">ã‚·ã‚°ãƒ¢ã‚¤ãƒ‰é–¢æ•°ãªã©ã®å°å‡ºã«ä½¿ã‚ã‚Œã¾ã™ã€‚</span>
                lim<sub>nâ†’âˆ</sub> (1 + 1/n)â¿ = e â‰ˆ 2.718
                <span class="ja">ãƒã‚¤ãƒ”ã‚¢æ•° e ã®å®šç¾©ã€‚eË£ï¼ˆæ´»æ€§åŒ–é–¢æ•°ãƒ»softmaxç­‰ï¼‰ã®åœŸå°ã€‚</span>
              </div>
              <div class="hl-box hl-blue" style="margin-top:0.75rem">
                <span class="hl-title">ğŸ“Œ æˆæ¥­ã§ã®æ¥µé™ã®å‡ºã—æ–¹</span>
                â‘ ã¾ãšç›´æ¥ä»£å…¥ã—ã¦ã¿ã‚‹<br>
                â‘¡ 0/0 ã‚„ âˆ/âˆ ã«ãªã£ãŸã‚‰ â†’ å› æ•°åˆ†è§£ãƒ»ç´„åˆ†<br>
                â‘¢ãã‚Œã§ã‚‚ãƒ€ãƒ¡ãªã‚‰ â†’ ãƒ­ãƒ”ã‚¿ãƒ«ã®å®šç†ï¼ˆä¸Šç´šï¼‰
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent2)"></div>
              <span class="card-title">ã‚ˆãå‡ºã‚‹æ¥µé™ã®è¨ˆç®—ä¾‹</span>
            </div>
            <div class="card-body">
              <div class="ex-grid">
                <div class="ex-card">
                  <span class="ex-orig">lim<sub>xâ†’3</sub> (xÂ² âˆ’ 9)/(x âˆ’ 3)</span>
                  <span class="ex-arrow">= lim (x+3)(xâˆ’3)/(xâˆ’3)</span>
                  <span class="ex-res">= lim (x+3) = 6</span>
                  <span class="ex-ja">å› æ•°åˆ†è§£ã—ã¦ç´„åˆ†ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">lim<sub>xâ†’âˆ</sub> 1/x</span>
                  <span class="ex-arrow">x ãŒç„¡é™å¤§ã«ãªã‚‹ã¨</span>
                  <span class="ex-res">= 0</span>
                  <span class="ex-ja">xãŒå¤§ãããªã‚‹ã»ã©1/xã¯0ã«è¿‘ã¥ã</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">lim<sub>hâ†’0</sub> (x+h)Â²âˆ’xÂ²) / h</span>
                  <span class="ex-arrow">å±•é–‹ â†’ ç´„åˆ† â†’ hâ†’0</span>
                  <span class="ex-res">= 2x</span>
                  <span class="ex-ja">xÂ²ã®å¾®åˆ†ã®å®šç¾©å¼ã‹ã‚‰å°ãä¾‹</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- =========================================
         PAGE: å¾®åˆ†ã®ãƒ«ãƒ¼ãƒ«
    ========================================= -->
    <div class="page" id="page-rules">
      <div class="page-title">å¾®åˆ†ã®è¨ˆç®—ãƒ«ãƒ¼ãƒ«</div>
      <div class="page-subtitle">å…¬å¼ã‚’è¦šãˆã¦ã€é …ã”ã¨ã«ãƒ«ãƒ¼ãƒ«é©ç”¨ã™ã‚‹ã ã‘ã€‚æ‰‹é †ã•ãˆå®ˆã‚Œã°å¿…ãšè§£ã‘ã¾ã™</div>

      <div class="two-col">
        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent)"></div>
              <span class="card-title">ã¹ãä¹—å‰‡ï¼ˆæœ€é‡è¦ï¼‰</span>
            </div>
            <div class="card-body">
              <div class="formula-box">
                (xâ¿)' = n Â· xâ¿â»Â¹
                <span class="ja">ã€æ‰‹é †ã€‘â‘  æŒ‡æ•° n ã‚’å‰ï¼ˆä¿‚æ•°ï¼‰ã¨ã—ã¦å–ã‚Šå‡ºã™<br>ã€€ã€€ã€€ã€€â‘¡ æŒ‡æ•°ã‚’ nâˆ’1 ã«ã™ã‚‹</span>
                <span class="result">ä¾‹ï¼š(xâµ)' â†’ 5ã‚’å‰ã¸ãƒ»æŒ‡æ•°ã¯5-1=4 â†’ 5xâ´</span>
              </div>
              <div class="ex-grid">
                <div class="ex-card">
                  <span class="ex-orig">f(x) = xÂ²</span>
                  <span class="ex-arrow">n=2 â†’ å‰ã¸ã€2-1=1</span>
                  <span class="ex-res">f'(x) = 2x</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">f(x) = xÂ³</span>
                  <span class="ex-arrow">n=3 â†’ å‰ã¸ã€3-1=2</span>
                  <span class="ex-res">f'(x) = 3xÂ²</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">f(x) = x</span>
                  <span class="ex-arrow">n=1 â†’ å‰ã¸ã€1-1=0ã€xâ°=1</span>
                  <span class="ex-res">f'(x) = 1</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">f(x) = 1/x = xâ»Â¹</span>
                  <span class="ex-arrow">n=-1 â†’ å‰ã¸ã€-1-1=-2</span>
                  <span class="ex-res">f'(x) = -xâ»Â² = -1/xÂ²</span>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent4)"></div>
              <span class="card-title">å®šæ•°ãƒ»å®šæ•°å€ãƒ»å’Œå·®</span>
            </div>
            <div class="card-body">
              <div class="formula-box" style="border-left-color:var(--accent4)">
                (c)' = 0 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â† å®šæ•°ã¯å¾®åˆ†ã™ã‚‹ã¨ 0
                <span class="ja">å®šæ•°ã¯å¤‰åŒ–ã—ãªã„ï¼ˆã‚°ãƒ©ãƒ•ãŒæ°´å¹³ç·šï¼‰ã®ã§å‚¾ã=0</span>
                (cÂ·f)' = cÂ·f' &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â† ä¿‚æ•°ã¯ãã®ã¾ã¾æ®‹ã™
                <span class="ja">3xÂ²ã‚’å¾®åˆ†ã™ã‚‹ã¨ãï¼š3ã¯ãã®ã¾ã¾ã€xÂ²ã ã‘å¾®åˆ† â†’ 3Â·2x = 6x</span>
                (f Â± g)' = f' Â± g' &nbsp;&nbsp;&nbsp;â† é …ã”ã¨ã«åˆ¥ã€…ã«å¾®åˆ†
                <span class="ja">è¶³ã—ç®—ãƒ»å¼•ãç®—ã§ã¤ãªãŒã‚ŒãŸå¼ã¯å„é …ã‚’ãƒãƒ©ã—ã¦å¾®åˆ†</span>
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent5)"></div>
              <span class="card-title">åŸºæœ¬é–¢æ•°ã®å¾®åˆ†ï¼ˆæš—è¨˜æ¨å¥¨ï¼‰</span>
            </div>
            <div class="card-body">
              <div class="ex-grid">
                <div class="ex-card">
                  <span class="ex-orig">(sin x)' =</span>
                  <span class="ex-res">cos x</span>
                  <span class="ex-ja">sin â†’ cosï¼ˆä¸€å€‹é€²ã‚€ï¼‰</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">(cos x)' =</span>
                  <span class="ex-res">âˆ’sin x</span>
                  <span class="ex-ja">cos â†’ âˆ’sinï¼ˆãƒã‚¤ãƒŠã‚¹ã«æ³¨æ„ï¼‰</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">(eË£)' =</span>
                  <span class="ex-res">eË£ âœ¨</span>
                  <span class="ex-ja">å¾®åˆ†ã—ã¦ã‚‚å¤‰ã‚ã‚‰ãªã„ï¼</span>
                </div>
                <div class="ex-card">
                  <span class="ex-orig">(ln x)' =</span>
                  <span class="ex-res">1/x</span>
                  <span class="ex-ja">æå¤±é–¢æ•°ã®è¨ˆç®—ã§ã‚ˆãç™»å ´</span>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent2)"></div>
              <span class="card-title">å®Ÿè·µï¼šè¨ˆç®—ã®æ‰‹é †ï¼ˆå•é¡Œã‚’è§£ãæµã‚Œï¼‰</span>
            </div>
            <div class="card-body">
              <div class="step-list">
                <div class="step-item">
                  <div class="step-num">1</div>
                  <div class="step-text">å¼ã‚’ <strong>+ãƒ»âˆ’</strong> ã§åŒºåˆ‡ã£ã¦ã€Œé …ã€ã«åˆ†è§£ã™ã‚‹</div>
                </div>
                <div class="step-item">
                  <div class="step-num">2</div>
                  <div class="step-text">å„é …ã‚’ç¢ºèªï¼š<strong>å®šæ•°ï¼Ÿã€€xâ¿ï¼Ÿã€€sin/cos/eË£/lnï¼Ÿ</strong></div>
                </div>
                <div class="step-item">
                  <div class="step-num">3</div>
                  <div class="step-text">å„é …ã«ãƒ«ãƒ¼ãƒ«ã‚’é©ç”¨<br>
                    <span class="code">xâ¿ â†’ nxâ¿â»Â¹ã€€|ã€€å®šæ•° â†’ 0ã€€|ã€€ä¿‚æ•°ã¯ãã®ã¾ã¾</span>
                  </div>
                </div>
                <div class="step-item">
                  <div class="step-num">4</div>
                  <div class="step-text">é …ã‚’è¶³ã—åˆã‚ã›ã¦å®Œæˆï¼</div>
                </div>
              </div>
              <div class="hl-box hl-yellow">
                <span class="hl-title">ğŸ“ ç·´ç¿’ï¼šf(x) = 4xÂ³ âˆ’ 2xÂ² + 5x âˆ’ 8</span>
                4xÂ³ â†’ 4Ã—3xÂ² = <strong style="color:var(--accent)">12xÂ²</strong><br>
                2xÂ² â†’ 2Ã—2x = <strong style="color:var(--accent)">4x</strong>ï¼ˆå¼•ãç®—ãªã®ã§ãƒã‚¤ãƒŠã‚¹ï¼‰<br>
                5x &nbsp;â†’ 5Ã—1 = <strong style="color:var(--accent)">5</strong><br>
                8 &nbsp;&nbsp;â†’ å®šæ•° = <strong style="color:var(--accent)">0</strong><br>
                <strong style="color:var(--accent2)">âˆ´ f'(x) = 12xÂ² âˆ’ 4x + 5</strong>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- =========================================
         PAGE: åå¾®åˆ†
    ========================================= -->
    <div class="page" id="page-partial">
      <div class="page-title">åå¾®åˆ†ï¼ˆPartial Derivativeï¼‰</div>
      <div class="page-subtitle">å¤‰æ•°ãŒè¤‡æ•°ã‚ã‚‹ã¨ãã®å¾®åˆ† â€” æ©Ÿæ¢°å­¦ç¿’ã®é‡ã¿ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ›´æ–°ã«ç›´çµ</div>

      <div class="two-col">
        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent5)"></div>
              <span class="card-title">åå¾®åˆ†ã¨ã¯</span>
            </div>
            <div class="card-body">
              <p style="font-size:0.85rem; margin-bottom:0.75rem">
                å¤‰æ•°ãŒ x ã ã‘ã§ãªãã€x, y, zâ€¦ ã¨è¤‡æ•°ã‚ã‚‹ã¨ãã€<strong style="color:var(--accent5)">ä¸€ã¤ã®å¤‰æ•°ã ã‘ã«æ³¨ç›®ã—ã¦å¾®åˆ†ã™ã‚‹</strong>æ–¹æ³•ã§ã™ã€‚ä»–ã®å¤‰æ•°ã¯ã€Œå®šæ•°ã¨ã¿ãªã—ã¦ã€è¨ˆç®—ã—ã¾ã™ã€‚
              </p>
              <div class="formula-box" style="border-left-color:var(--accent5)">
                âˆ‚f/âˆ‚x &nbsp;= x ã«ã¤ã„ã¦åå¾®åˆ†
                <span class="ja">è¨˜å·ã¯ã€Œâˆ‚ï¼ˆãƒ©ã‚¦ãƒ³ãƒ‰ãƒ‡ã‚£ãƒ¼ï¼‰ã€ã€‚æ™®é€šã®å¾®åˆ†ã® d ã¨åŒºåˆ¥ã—ã¾ã™ã€‚</span>
                âˆ‚f/âˆ‚y &nbsp;= y ã«ã¤ã„ã¦åå¾®åˆ†
                <span class="ja">ã€Œâˆ‚f/âˆ‚x ã‚’æ±‚ã‚ã‚‹ã¨ãã¯ã€y ã‚’å®šæ•°ã¨ã¿ãªã™ã€ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã€‚</span>
              </div>
              <div class="hl-box hl-purple">
                <span class="hl-title">ğŸ’¡ ã€Œä»–ã®å¤‰æ•°ã¯å®šæ•°ã€ã®æ„å‘³</span>
                f(x, y) = xÂ² + 3xy + yÂ²<br>
                x ã«ã¤ã„ã¦åå¾®åˆ†ã™ã‚‹ã¨ãï¼š<strong style="color:var(--accent5)">y ã¯æ•°å­—ã¨åŒã˜</strong>ã¨è€ƒãˆã‚‹ã€‚<br>
                â†’ y ã¯ã€Œ2ã®æ•°å­—ã€ã¿ãŸã„ãªæ‰±ã„ã€‚yÂ²ã¯ y ãŒå®šæ•°ãªã®ã§å¾®åˆ†=0ã€‚
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent)"></div>
              <span class="card-title">è¨ˆç®—ä¾‹ï¼šã‚¹ãƒ†ãƒƒãƒ—ã§è¿½ã†</span>
            </div>
            <div class="card-body">
              <div class="hl-box hl-green">
                <span class="hl-title">å•é¡Œï¼šf(x, y) = xÂ² + 3xy + yÂ² ã‚’åå¾®åˆ†ã›ã‚ˆ</span>
              </div>
              <div class="step-list" style="margin-top:0.75rem">
                <div class="step-item">
                  <div class="step-num">â‘ </div>
                  <div class="step-text">
                    <strong>âˆ‚f/âˆ‚x ã‚’æ±‚ã‚ã‚‹ï¼ˆy ã‚’å®šæ•°ã¨ã¿ãªã™ï¼‰</strong><br>
                    <span class="code">xÂ²</span> â†’ ã¹ãä¹—å‰‡ã§ <span class="code">2x</span><br>
                    <span class="code">3xy</span> â†’ y ã¯å®šæ•°ãªã®ã§ <span class="code">3y</span>ï¼ˆä¿‚æ•°æ‰±ã„ï¼‰Ã— x ã®å¾®åˆ† 1<br>
                    <span class="code">yÂ²</span> â†’ y ã ã‘ã®å¼ã€x ã‚’å«ã¾ãªã„ã®ã§ <span class="code">0</span><br>
                    <strong style="color:var(--accent2)">âˆ´ âˆ‚f/âˆ‚x = 2x + 3y</strong>
                  </div>
                </div>
                <div class="step-item">
                  <div class="step-num">â‘¡</div>
                  <div class="step-text">
                    <strong>âˆ‚f/âˆ‚y ã‚’æ±‚ã‚ã‚‹ï¼ˆx ã‚’å®šæ•°ã¨ã¿ãªã™ï¼‰</strong><br>
                    <span class="code">xÂ²</span> â†’ x ã ã‘ã®å¼ãªã®ã§ <span class="code">0</span><br>
                    <span class="code">3xy</span> â†’ x ã¯å®šæ•°ãªã®ã§ <span class="code">3x</span>ï¼ˆä¿‚æ•°æ‰±ã„ï¼‰Ã— y ã®å¾®åˆ† 1<br>
                    <span class="code">yÂ²</span> â†’ ã¹ãä¹—å‰‡ã§ <span class="code">2y</span><br>
                    <strong style="color:var(--accent2)">âˆ´ âˆ‚f/âˆ‚y = 3x + 2y</strong>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent2)"></div>
              <span class="card-title">æ©Ÿæ¢°å­¦ç¿’ã§ã®åå¾®åˆ†ã®å½¹å‰²</span>
            </div>
            <div class="card-body">
              <div class="hl-box hl-yellow">
                <span class="hl-title">ğŸ¤– ãªãœæ©Ÿæ¢°å­¦ç¿’ã«åå¾®åˆ†ãŒå¿…è¦ã‹</span>
                ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã¯<strong style="color:var(--accent2)">ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆé‡ã¿ï¼‰ãŒä½•ä¸‡å€‹</strong>ã‚‚ã‚ã‚Šã¾ã™ã€‚<br>æå¤±ã‚’æœ€å°ã«ã™ã‚‹ã«ã¯ã€Œå„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å°‘ã—å¤‰ãˆã‚‹ã¨æå¤±ãŒã©ã†å¤‰ã‚ã‚‹ã‹ã€ã‚’åå¾®åˆ†ã§è¨ˆç®—ã—ã¾ã™ã€‚
              </div>
              <div class="formula-box" style="border-left-color:var(--accent2)">
                æå¤± L = f(wâ‚, wâ‚‚, wâ‚ƒ ... wâ‚™)<br><br>
                âˆ‚L/âˆ‚wâ‚ = wâ‚ ã‚’å¤‰ãˆãŸã¨ãã®æå¤±ã®å¤‰åŒ–
                <span class="ja">wâ‚ ã ã‘ã«æ³¨ç›®ã—ã¦åå¾®åˆ†ã€‚ä»–ã®é‡ã¿ã¯å®šæ•°ã¨ã¿ãªã™ã€‚</span>
                âˆ‚L/âˆ‚wâ‚‚ = wâ‚‚ ã‚’å¤‰ãˆãŸã¨ãã®æå¤±ã®å¤‰åŒ–
                <span class="ja">åŒæ§˜ã« wâ‚‚ ã«ã¤ã„ã¦ã€‚ã“ã‚Œã‚’å…¨ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å®Ÿæ–½ = ãƒãƒƒã‚¯ãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³</span>
              </div>
              <div class="hl-box hl-blue" style="margin-top:0.75rem">
                <span class="hl-title">ğŸ“Œ ã‚·ãƒ³ãƒ—ãƒ«ãªç·šå½¢å›å¸°ã®ä¾‹</span>
                L(w, b) = Î£(y - (wx + b))Â²<br>
                âˆ‚L/âˆ‚w â†’ w ã«ã¤ã„ã¦ã®åå¾®åˆ†ï¼ˆb ã¯å®šæ•°ï¼‰<br>
                âˆ‚L/âˆ‚b â†’ b ã«ã¤ã„ã¦ã®åå¾®åˆ†ï¼ˆw ã¯å®šæ•°ï¼‰<br>
                ã“ã®2ã¤ã§ w ã¨ b ã®æ›´æ–°æ–¹å‘ãŒã‚ã‹ã‚Šã¾ã™ã€‚
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent3)"></div>
              <span class="card-title">åå¾®åˆ†ã®è¨ˆç®—æ‰‹é †ã¾ã¨ã‚</span>
            </div>
            <div class="card-body">
              <div class="step-list">
                <div class="step-item">
                  <div class="step-num">1</div>
                  <div class="step-text"><strong>ã©ã®å¤‰æ•°ã§åå¾®åˆ†ã™ã‚‹ã‹</strong>ç¢ºèªã™ã‚‹ï¼ˆâˆ‚/âˆ‚x ãªã‚‰ x ã«æ³¨ç›®ï¼‰</div>
                </div>
                <div class="step-item">
                  <div class="step-num">2</div>
                  <div class="step-text"><strong>æ³¨ç›®ã™ã‚‹å¤‰æ•°ä»¥å¤–ã¯ã™ã¹ã¦å®šæ•°æ‰±ã„</strong>ã«ã™ã‚‹</div>
                </div>
                <div class="step-item">
                  <div class="step-num">3</div>
                  <div class="step-text">ã‚ã¨ã¯æ™®é€šã®å¾®åˆ†ã¨åŒã˜ãƒ«ãƒ¼ãƒ«ã§è¨ˆç®—ã™ã‚‹</div>
                </div>
                <div class="step-item">
                  <div class="step-num">4</div>
                  <div class="step-text">æ³¨ç›®å¤‰æ•°ã‚’å«ã¾ãªã„é …ã¯<strong>0ã«ãªã‚‹</strong>ï¼ˆå®šæ•°ã®å¾®åˆ†ï¼0ï¼‰</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- =========================================
         PAGE: å‹¾é…é™ä¸‹æ³•
    ========================================= -->
    <div class="page" id="page-gradient">
      <div class="page-title">å‹¾é…ã¨å‹¾é…é™ä¸‹æ³•</div>
      <div class="page-subtitle">æ©Ÿæ¢°å­¦ç¿’ã®ã€Œå­¦ç¿’ã€ãã®ã‚‚ã® â€” åå¾®åˆ†ã‚’ä½¿ã£ã¦æœ€å°å€¤ã‚’æ¢ã™</div>

      <div class="two-col">
        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent)"></div>
              <span class="card-title">å‹¾é…ï¼ˆGradientï¼‰ã¨ã¯</span>
            </div>
            <div class="card-body">
              <p style="font-size:0.85rem; margin-bottom:0.75rem">
                è¤‡æ•°ã®å¤‰æ•°ã«å¯¾ã™ã‚‹åå¾®åˆ†ã‚’<strong style="color:var(--accent)">ãƒ™ã‚¯ãƒˆãƒ«ã«ã¾ã¨ã‚ãŸã‚‚ã®</strong>ãŒå‹¾é…ï¼ˆã‚°ãƒ©ã‚¸ã‚§ãƒ³ãƒˆï¼‰ã§ã™ã€‚ã€Œä¸€ç•ªæ€¥ãªä¸Šã‚Šå‚ã®æ–¹å‘ã¨å‚¾ãã®å¤§ãã•ã€ã‚’ç¤ºã—ã¾ã™ã€‚
              </p>
              <div class="formula-box">
                âˆ‡f = (âˆ‚f/âˆ‚x, âˆ‚f/âˆ‚y)
                <span class="ja">ã€ŒãƒŠãƒ–ãƒ© fã€ã¨èª­ã‚€ã€‚å„æ–¹å‘ã®åå¾®åˆ†ã‚’ä¸¦ã¹ãŸãƒ™ã‚¯ãƒˆãƒ«ã€‚<br>ã“ã®æ–¹å‘ã«é€²ã‚€ã¨ f ãŒæœ€ã‚‚æ€¥ã«å¢—åŠ ã—ã¾ã™ã€‚</span>
              </div>
              <div class="hl-box hl-green">
                <span class="hl-title">ğŸ”ï¸ å±±ã®ãŸã¨ãˆ</span>
                éœ§ã®å±±ã§ã€Œæœ€çŸ­ã§éº“ã«é™ã‚Šã‚‹ã€ã“ã¨ã‚’è€ƒãˆã¾ã™ã€‚<br>
                å‹¾é… = <strong>ã€Œä»Šç«‹ã£ã¦ã„ã‚‹å ´æ‰€ã®ä¸€ç•ªæ€¥ãªæ–œé¢ã®æ–¹å‘ã€</strong><br>
                å‹¾é…é™ä¸‹æ³• = <strong>ã€Œãã®é€†æ–¹å‘ï¼ˆä¸‹ã‚Šï¼‰ã«ä¸€æ­©ãšã¤é€²ã‚€ã€</strong><br>
                ã“ã‚Œã‚’ç¹°ã‚Šè¿”ã™ã¨è°·åº•ï¼ˆæå¤±æœ€å°ï¼‰ã«è¾¿ã‚Šç€ãã€‚
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent2)"></div>
              <span class="card-title">å‹¾é…é™ä¸‹æ³•ã®ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ </span>
            </div>
            <div class="card-body">
              <div class="formula-box" style="border-left-color:var(--accent2)">
                w := w âˆ’ Î· Â· (âˆ‚L/âˆ‚w)
                <span class="ja">w = ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆé‡ã¿ï¼‰<br>Î·ï¼ˆã‚¤ãƒ¼ã‚¿ï¼‰= å­¦ç¿’ç‡ï¼ˆä¸€æ­©ã®å¤§ãã•ï¼‰<br>âˆ‚L/âˆ‚w = æå¤±ã® w ã«å¯¾ã™ã‚‹åå¾®åˆ†ï¼ˆå‚¾ãï¼‰</span>
                <span class="result">ã€èª­ã¿æ–¹ã€‘ã€Œä»Šã®é‡ã¿ã‹ã‚‰ã€æå¤±ã®å‚¾ãÃ—å­¦ç¿’ç‡ã‚’å¼•ãã€</span>
              </div>
              <div class="step-list" style="margin-top:0.75rem">
                <div class="step-item">
                  <div class="step-num">1</div>
                  <div class="step-text">ç¾åœ¨ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã§<strong>æå¤± L ã‚’è¨ˆç®—</strong></div>
                </div>
                <div class="step-item">
                  <div class="step-num">2</div>
                  <div class="step-text">å„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®<strong>åå¾®åˆ†ï¼ˆå‹¾é…ï¼‰ã‚’è¨ˆç®—</strong>ï¼ˆãƒãƒƒã‚¯ãƒ—ãƒ­ãƒ‘ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰</div>
                </div>
                <div class="step-item">
                  <div class="step-num">3</div>
                  <div class="step-text"><strong>å‹¾é…ã®é€†æ–¹å‘ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ›´æ–°</strong><br><span class="code">w = w - Î· Ã— (âˆ‚L/âˆ‚w)</span></div>
                </div>
                <div class="step-item">
                  <div class="step-num">4</div>
                  <div class="step-text">æå¤±ãŒååˆ†å°ã•ããªã‚‹ã¾ã§<strong>1ã€œ3ã‚’ç¹°ã‚Šè¿”ã™</strong></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent3)"></div>
              <span class="card-title">å­¦ç¿’ç‡ Î· ã®é‡è¦æ€§</span>
            </div>
            <div class="card-body">
              <div class="hl-box hl-red">
                <span class="hl-title">âš ï¸ Î· ãŒå¤§ãã™ãã‚‹å ´åˆ</span>
                ä¸€æ­©ãŒå¤§ãã™ãã¦è°·ã‚’é£›ã³è¶Šã—ã¦ã—ã¾ã†ã€‚æå¤±ãŒæŒ¯å‹•ãƒ»ç™ºæ•£ã—ã¦å­¦ç¿’ãŒåæŸã—ãªã„ã€‚
              </div>
              <div class="hl-box hl-blue" style="margin-top:0.5rem">
                <span class="hl-title">âš ï¸ Î· ãŒå°ã•ã™ãã‚‹å ´åˆ</span>
                ä¸€æ­©ãŒå°ã•ã™ãã¦æœ€å°å€¤ã«è¾¿ã‚Šç€ãã¾ã§ã«æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã‚‹ã€‚å±€æ‰€æœ€å°å€¤ã«åµŒã‚‹å¯èƒ½æ€§ã‚‚ã€‚
              </div>
              <div class="hl-box hl-green" style="margin-top:0.5rem">
                <span class="hl-title">âœ… ã¡ã‚‡ã†ã©ã„ã„ Î·</span>
                æå¤±ãŒå®‰å®šã—ã¦æ¸›å°‘ã—ã¦ã„ãã€‚<br>å®Ÿéš›ã¯ 0.001ã€œ0.01 ç¨‹åº¦ã‹ã‚‰ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦èª¿æ•´ã—ã¾ã™ã€‚
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent4)"></div>
              <span class="card-title">æ•°å­¦â†’æ©Ÿæ¢°å­¦ç¿’ã®å¯¾å¿œè¡¨</span>
            </div>
            <div class="card-body">
              <div class="formula-box" style="border-left-color:var(--accent4); line-height:2.5; font-size:0.8rem">
                æ•°å­¦ã®æ¦‚å¿µ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†’ &nbsp;ML ã§ã®æ„å‘³<br>
                â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€<br>
                <span style="color:var(--accent4)">f(x)</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†’ &nbsp;<span style="color:var(--text-mid)">æå¤±é–¢æ•° L(w)</span><br>
                <span class="ja">ã€Œèª¤å·®ãŒã©ã‚Œãã‚‰ã„ã‹ã€ã‚’æ¸¬ã‚‹é–¢æ•°</span>
                <span style="color:var(--accent4)">x</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†’ &nbsp;<span style="color:var(--text-mid)">é‡ã¿ wï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼‰</span><br>
                <span class="ja">æœ€é©åŒ–ã—ãŸã„å¤‰æ•°</span>
                <span style="color:var(--accent4)">f'(x) = 0</span> &nbsp;&nbsp;&nbsp;&nbsp;â†’ &nbsp;<span style="color:var(--text-mid)">æå¤±ã®æœ€å°å€¤</span><br>
                <span class="ja">å‹¾é…=0 ã®ç‚¹ãŒæœ€é©è§£ï¼ˆå€™è£œï¼‰</span>
                <span style="color:var(--accent4)">âˆ‡f</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;â†’ &nbsp;<span style="color:var(--text-mid)">å‹¾é…ãƒ™ã‚¯ãƒˆãƒ«</span><br>
                <span class="ja">å„é‡ã¿ã®æ›´æ–°æ–¹å‘ã‚’æ±ºã‚ã‚‹</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- =========================================
         PAGE: ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–
    ========================================= -->
    <div class="page" id="page-visual">
      <div class="page-title">ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ã‚°ãƒ©ãƒ•</div>
      <div class="page-subtitle">é–¢æ•°ã¨å°é–¢æ•°ã‚’è¦–è¦šçš„ã«ç¢ºèª â€” æ¥ç·šã‚’å‹•ã‹ã—ã¦å¾®åˆ†ã®æ„å‘³ã‚’ä½“æ„Ÿ</div>

      <div class="two-col">
        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent4)"></div>
              <span class="card-title">é–¢æ•°ã‚°ãƒ©ãƒ• &amp; æ¥ç·š</span>
            </div>
            <div class="card-body">
              <div id="funcTabsV" style="display:flex; gap:0.5rem; flex-wrap:wrap; margin-bottom:0.75rem">
                <button class="ex-card" style="cursor:pointer;padding:0.3rem 0.7rem;border-radius:6px;font-family:'Space Mono',monospace;font-size:0.78rem;border:1px solid var(--accent4);color:var(--accent4);background:rgba(116,185,255,0.1)" onclick="setFunc('x2',this)">xÂ²</button>
                <button class="ex-card" style="cursor:pointer;padding:0.3rem 0.7rem;border-radius:6px;font-family:'Space Mono',monospace;font-size:0.78rem" onclick="setFunc('x3',this)">xÂ³</button>
                <button class="ex-card" style="cursor:pointer;padding:0.3rem 0.7rem;border-radius:6px;font-family:'Space Mono',monospace;font-size:0.78rem" onclick="setFunc('sinx',this)">sin(x)</button>
                <button class="ex-card" style="cursor:pointer;padding:0.3rem 0.7rem;border-radius:6px;font-family:'Space Mono',monospace;font-size:0.78rem" onclick="setFunc('ex',this)">eË£</button>
                <button class="ex-card" style="cursor:pointer;padding:0.3rem 0.7rem;border-radius:6px;font-family:'Space Mono',monospace;font-size:0.78rem" onclick="setFunc('loss',this)">æå¤±é–¢æ•°é¢¨</button>
              </div>
              <canvas id="gCanvas" height="260"></canvas>
              <div class="ctrl-row">
                <span class="ctrl-label">x =</span>
                <input type="range" id="xSl" min="-3" max="3" step="0.05" value="0" oninput="updateSlider(this.value)">
                <span class="val-badge" id="xBadge">0.00</span>
              </div>
              <div class="info-grid">
                <div class="info-cell">
                  <div class="lbl">f(x)</div>
                  <div class="val" id="vFx" style="color:var(--accent4)">â€”</div>
                </div>
                <div class="info-cell">
                  <div class="lbl">f'(x) å‚¾ã</div>
                  <div class="val" id="vDx" style="color:var(--accent2)">â€”</div>
                </div>
                <div class="info-cell">
                  <div class="lbl">å‚¾ãã®æ„å‘³</div>
                  <div class="val" id="vSign" style="color:var(--accent3); font-size:0.75rem">â€”</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div>
          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent)"></div>
              <span class="card-title">å°é–¢æ•°ã‚°ãƒ©ãƒ• f'(x)</span>
            </div>
            <div class="card-body">
              <canvas id="dCanvas" height="260"></canvas>
              <div class="hl-box hl-green" style="margin-top:0.75rem; font-size:0.8rem">
                <span class="hl-title">ğŸ“Š è¦‹æ–¹</span>
                ç·‘ã®æ›²ç·šãŒ f'(x)ï¼ˆå°é–¢æ•°ï¼‰ã€‚é»„è‰²ã„ç¸¦ç·šãŒç¾åœ¨ã® x ä½ç½®ã€‚<br>
                ç¸¦è»¸ã®å€¤ï¼ãã®ç‚¹ã§ã®å‚¾ãï¼ˆä¸Šã‚°ãƒ©ãƒ•ã®æ¥ç·šã®å‚¾ãï¼‰ã§ã™ã€‚<br>
                <strong>å°é–¢æ•°ãŒã‚¼ãƒ­ã«ãªã‚‹å ´æ‰€</strong>ï¼å…ƒã®é–¢æ•°ã®å±±ãƒ»è°·ã®ä½ç½®ã€‚
              </div>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-dot" style="background:var(--accent5)"></div>
              <span class="card-title">å‹¾é…é™ä¸‹æ³•ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³</span>
            </div>
            <div class="card-body">
              <canvas id="gradCanvas" height="200"></canvas>
              <div class="ctrl-row">
                <span class="ctrl-label">å­¦ç¿’ç‡ Î· =</span>
                <input type="range" id="lrSl" min="0.01" max="0.5" step="0.01" value="0.1" oninput="updateLR(this.value)">
                <span class="val-badge" id="lrBadge">0.10</span>
              </div>
              <div class="ctrl-row" style="margin-top:0.5rem">
                <button onclick="resetGD()" style="background:var(--surface2);border:1px solid var(--border);color:var(--text);padding:0.4rem 1rem;border-radius:6px;font-size:0.8rem;cursor:pointer;flex:1">ãƒªã‚»ãƒƒãƒˆ</button>
                <button onclick="stepGD()" style="background:var(--accent);border:1px solid var(--accent);color:var(--bg);padding:0.4rem 1rem;border-radius:6px;font-size:0.8rem;cursor:pointer;font-weight:700;flex:1">1ã‚¹ãƒ†ãƒƒãƒ—</button>
                <button onclick="autoGD()" style="background:var(--accent2);border:1px solid var(--accent2);color:var(--bg);padding:0.4rem 1rem;border-radius:6px;font-size:0.8rem;cursor:pointer;font-weight:700;flex:1" id="autoBtn">è‡ªå‹•å®Ÿè¡Œ</button>
              </div>
              <div class="info-grid" style="margin-top:0.75rem">
                <div class="info-cell">
                  <div class="lbl">ç¾åœ¨ã® w</div>
                  <div class="val" id="gdW" style="color:var(--accent2)">â€”</div>
                </div>
                <div class="info-cell">
                  <div class="lbl">æå¤± L(w)</div>
                  <div class="val" id="gdL" style="color:var(--accent3)">â€”</div>
                </div>
                <div class="info-cell">
                  <div class="lbl">ã‚¹ãƒ†ãƒƒãƒ—</div>
                  <div class="val" id="gdStep" style="color:var(--text-dim)">0</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  </main>
</div>

<!-- Mobile nav -->
<nav class="mobile-nav">
  <button onclick="goPage('slope',this)" class="active"><span class="m-icon">ğŸ“</span>å¤‰åŒ–ç‡</button>
  <button onclick="goPage('limit',this)"><span class="m-icon">âˆ</span>æ¥µé™</button>
  <button onclick="goPage('rules',this)"><span class="m-icon">ğŸ“</span>ãƒ«ãƒ¼ãƒ«</button>
  <button onclick="goPage('partial',this)"><span class="m-icon">âˆ‚</span>åå¾®åˆ†</button>
  <button onclick="goPage('gradient',this)"><span class="m-icon">â–½</span>å‹¾é…</button>
  <button onclick="goPage('visual',this)"><span class="m-icon">ğŸ“Š</span>ã‚°ãƒ©ãƒ•</button>
</nav>

<script>
// ===== Navigation =====
function goPage(name, el) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + name).classList.add('active');
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  document.querySelectorAll('.mobile-nav button').forEach(n => n.classList.remove('active'));
  if (el) {
    el.classList.add('active');
    // Also sync the other nav
    const allNavs = [...document.querySelectorAll('.nav-item'), ...document.querySelectorAll('.mobile-nav button')];
    allNavs.forEach(n => { if (n.dataset.page === name || n.getAttribute('onclick') && n.getAttribute('onclick').includes("'"+name+"'")) n.classList.add('active'); });
  }
  if (name === 'visual') { setTimeout(resizeCanvases, 50); }
}

// ===== Functions =====
const funcs = {
  x2:   { f: x => x*x,             df: x => 2*x,              label:'f(x)=xÂ²',     dlabel:"f'(x)=2x",     xr:[-3.5,3.5], yr:[-1,10] },
  x3:   { f: x => x*x*x,           df: x => 3*x*x,            label:'f(x)=xÂ³',     dlabel:"f'(x)=3xÂ²",    xr:[-2.5,2.5], yr:[-10,10] },
  sinx: { f: x => Math.sin(x),     df: x => Math.cos(x),      label:'f(x)=sin(x)', dlabel:"f'(x)=cos(x)", xr:[-7,7],     yr:[-1.5,1.5] },
  ex:   { f: x => Math.exp(x),     df: x => Math.exp(x),      label:'f(x)=eË£',     dlabel:"f'(x)=eË£",     xr:[-3,2.5],   yr:[-0.5,12] },
  loss: { f: x => (x-1)*(x-1)*0.5, df: x => (x-1),            label:'L(w)=(w-1)Â²/2', dlabel:"L'(w)=w-1",  xr:[-2,4],    yr:[-0.2,3] }
};

let cf = 'x2', cx = 0;

function setFunc(name, btn) {
  cf = name;
  document.querySelectorAll('#funcTabsV button').forEach(b => {
    b.style.color = 'var(--text-dim)'; b.style.border='1px solid var(--border)'; b.style.background='none';
  });
  btn.style.color='var(--accent4)'; btn.style.border='1px solid var(--accent4)'; btn.style.background='rgba(116,185,255,0.1)';
  const fn = funcs[name];
  const sl = document.getElementById('xSl');
  sl.min = fn.xr[0]; sl.max = fn.xr[1];
  cx = Math.max(fn.xr[0], Math.min(fn.xr[1], cx));
  sl.value = cx;
  drawAll();
}

function updateSlider(v) { cx = parseFloat(v); drawAll(); }

// ===== Canvas drawing =====
const gCv = () => document.getElementById('gCanvas');
const dCv = () => document.getElementById('dCanvas');

function resizeCanvases() {
  const g = gCv(), d = dCv(), gr = document.getElementById('gradCanvas');
  if (!g) return;
  const w = g.parentElement.clientWidth - 40;
  g.width = w; g.height = 260;
  d.width = w; d.height = 260;
  gr.width = gr.parentElement.clientWidth - 40; gr.height = 200;
  drawAll(); drawGD();
}

function w2c(cv, x, y, xmn, xmx, ymn, ymx) {
  const W = cv.width, H = cv.height;
  return [(x-xmn)/(xmx-xmn)*W, H-(y-ymn)/(ymx-ymn)*H];
}

function drawGrid(ctx, xmn, xmx, ymn, ymx) {
  const W = ctx.canvas.width, H = ctx.canvas.height;
  ctx.strokeStyle = '#1a1a28'; ctx.lineWidth = 1;
  for (let x=Math.ceil(xmn); x<=xmx; x++) {
    const [px] = w2c(ctx.canvas, x, 0, xmn, xmx, ymn, ymx);
    ctx.beginPath(); ctx.moveTo(px, 0); ctx.lineTo(px, H); ctx.stroke();
  }
  for (let y=Math.ceil(ymn); y<=ymx; y++) {
    const [, py] = w2c(ctx.canvas, 0, y, xmn, xmx, ymn, ymx);
    ctx.beginPath(); ctx.moveTo(0, py); ctx.lineTo(W, py); ctx.stroke();
  }
  ctx.strokeStyle = '#2a2a44'; ctx.lineWidth = 1.5;
  const [ax] = w2c(ctx.canvas, 0, 0, xmn, xmx, ymn, ymx);
  const [, ay] = w2c(ctx.canvas, 0, 0, xmn, xmx, ymn, ymx);
  ctx.beginPath(); ctx.moveTo(ax, 0); ctx.lineTo(ax, H); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(0, ay); ctx.lineTo(W, ay); ctx.stroke();
}

function drawCurve(ctx, fn, xmn, xmx, ymn, ymx, color, lw=2) {
  const W = ctx.canvas.width;
  ctx.strokeStyle = color; ctx.lineWidth = lw;
  ctx.beginPath(); let started = false;
  for (let px=0; px<=W; px+=0.5) {
    const x = xmn + (px/W)*(xmx-xmn);
    const y = fn(x);
    if (isNaN(y)||!isFinite(y)||y<ymn-30||y>ymx+30) { started=false; continue; }
    const [, py] = w2c(ctx.canvas, x, y, xmn, xmx, ymn, ymx);
    if (!started) { ctx.moveTo(px, py); started=true; } else { ctx.lineTo(px, py); }
  }
  ctx.stroke();
}

function derivRange(df, xmn, xmx) {
  let mn=Infinity, mx=-Infinity;
  for (let x=xmn; x<=xmx; x+=0.05) {
    const v=df(x); if(!isNaN(v)&&isFinite(v)){mn=Math.min(mn,v);mx=Math.max(mx,v);}
  }
  const pad=(mx-mn)*0.15||1; return [mn-pad, mx+pad];
}

function drawAll() {
  const fn = funcs[cf];
  const { f, df, xr, yr } = fn;
  const [xmn,xmx]=xr, [ymn,ymx]=yr;
  const g=gCv(), d=dCv();
  if (!g||!g.width) return;
  const gctx=g.getContext('2d'), dctx=d.getContext('2d');

  // Main
  gctx.clearRect(0,0,g.width,g.height);
  gctx.fillStyle='#080810'; gctx.fillRect(0,0,g.width,g.height);
  drawGrid(gctx,xmn,xmx,ymn,ymx);
  drawCurve(gctx,f,xmn,xmx,ymn,ymx,'#74b9ff',2.5);

  const cy_val = f(cx), slope = df(cx);
  if(!isNaN(cy_val)&&!isNaN(slope)) {
    const x1=cx-1.5, x2=cx+1.5;
    const y1=cy_val+slope*(x1-cx), y2=cy_val+slope*(x2-cx);
    const [px1,py1]=w2c(g,x1,y1,xmn,xmx,ymn,ymx);
    const [px2,py2]=w2c(g,x2,y2,xmn,xmx,ymn,ymx);
    gctx.strokeStyle='#f7b731'; gctx.lineWidth=2;
    gctx.setLineDash([5,4]); gctx.beginPath();
    gctx.moveTo(px1,py1); gctx.lineTo(px2,py2); gctx.stroke();
    gctx.setLineDash([]);
    const [ppx,ppy]=w2c(g,cx,cy_val,xmn,xmx,ymn,ymx);
    gctx.fillStyle='#f7b731'; gctx.beginPath(); gctx.arc(ppx,ppy,5,0,Math.PI*2); gctx.fill();
  }

  // Deriv
  const [drmin,drmax]=derivRange(df,xmn,xmx);
  dctx.clearRect(0,0,d.width,d.height);
  dctx.fillStyle='#080810'; dctx.fillRect(0,0,d.width,d.height);
  drawGrid(dctx,xmn,xmx,drmin,drmax);
  drawCurve(dctx,df,xmn,xmx,drmin,drmax,'#7ee8a2',2.5);
  const [vpx]=w2c(d,cx,0,xmn,xmx,drmin,drmax);
  dctx.strokeStyle='rgba(247,183,49,0.6)'; dctx.lineWidth=1.5;
  dctx.setLineDash([4,4]); dctx.beginPath(); dctx.moveTo(vpx,0); dctx.lineTo(vpx,d.height); dctx.stroke();
  dctx.setLineDash([]);
  const dv=df(cx);
  if(!isNaN(dv)) {
    const [dpx,dpy]=w2c(d,cx,dv,xmn,xmx,drmin,drmax);
    dctx.fillStyle='#f7b731'; dctx.beginPath(); dctx.arc(dpx,dpy,5,0,Math.PI*2); dctx.fill();
  }

  // Update info
  document.getElementById('xBadge').textContent = cx.toFixed(2);
  const fxv=f(cx); document.getElementById('vFx').textContent=isNaN(fxv)?'â€”':fxv.toFixed(3);
  const dfv=df(cx); document.getElementById('vDx').textContent=isNaN(dfv)?'â€”':dfv.toFixed(3);
  let signText='â€”';
  if(!isNaN(dfv)) {
    if(Math.abs(dfv)<0.05) signText='â‰ˆ0 (å±±/è°·ã®åº•)';
    else if(dfv>0) signText='æ­£ (ä¸Šæ˜‡ä¸­)';
    else signText='è²  (ä¸‹é™ä¸­)';
  }
  document.getElementById('vSign').textContent=signText;
}

// ===== Gradient Descent Simulation =====
let gdW = 2.5, gdLR = 0.1, gdSteps = 0, gdAuto = null;
const gdL = w => (w-1)*(w-1); // L(w) = (w-1)Â²
const gdDL = w => 2*(w-1);    // L'(w) = 2(w-1)

function drawGD() {
  const cv = document.getElementById('gradCanvas');
  if (!cv || !cv.width) return;
  const ctx = cv.getContext('2d');
  const W=cv.width, H=cv.height;
  const xmn=-3, xmx=4, ymn=-0.2, ymx=10;

  ctx.clearRect(0,0,W,H);
  ctx.fillStyle='#080810'; ctx.fillRect(0,0,W,H);
  drawGrid(ctx,xmn,xmx,ymn,ymx);
  drawCurve(ctx,gdL,xmn,xmx,ymn,ymx,'#d18cf7',2.5);

  // Current point
  const lv=gdL(gdW);
  if(gdW>=xmn&&gdW<=xmx&&lv>=ymn&&lv<=ymx) {
    const [px,py]=w2c(cv,gdW,lv,xmn,xmx,ymn,ymx);
    ctx.fillStyle='#f7b731';
    ctx.beginPath(); ctx.arc(px,py,7,0,Math.PI*2); ctx.fill();
    ctx.strokeStyle='#0b0b10'; ctx.lineWidth=2;
    ctx.beginPath(); ctx.arc(px,py,7,0,Math.PI*2); ctx.stroke();
    // Arrow showing direction
    const grad = gdDL(gdW);
    const newW = gdW - gdLR * grad;
    if(newW>=xmn&&newW<=xmx) {
      const [nx,ny]=w2c(cv,newW,gdL(newW),xmn,xmx,ymn,ymx);
      ctx.strokeStyle='rgba(126,232,162,0.6)'; ctx.lineWidth=1.5;
      ctx.setLineDash([3,3]);
      ctx.beginPath(); ctx.moveTo(px,py); ctx.lineTo(nx,ny); ctx.stroke();
      ctx.setLineDash([]);
    }
  }

  // Label
  ctx.fillStyle='#5a5a7a'; ctx.font='11px Space Mono,monospace';
  ctx.fillText('L(w) = (wâˆ’1)Â²', 8, 16);
  ctx.fillText('æœ€å°å€¤: w=1', 8, 30);

  // Info update
  document.getElementById('gdW').textContent=gdW.toFixed(3);
  document.getElementById('gdL').textContent=gdL(gdW).toFixed(4);
  document.getElementById('gdStep').textContent=gdSteps;
}

function stepGD() {
  const grad=gdDL(gdW);
  gdW = gdW - gdLR * grad;
  gdSteps++;
  drawGD();
}

function resetGD() {
  gdW=2.5; gdSteps=0;
  if(gdAuto){ clearInterval(gdAuto); gdAuto=null; document.getElementById('autoBtn').textContent='è‡ªå‹•å®Ÿè¡Œ'; document.getElementById('autoBtn').style.background='var(--accent2)'; }
  drawGD();
}

function updateLR(v) { gdLR=parseFloat(v); document.getElementById('lrBadge').textContent=parseFloat(v).toFixed(2); }

function autoGD() {
  if(gdAuto) {
    clearInterval(gdAuto); gdAuto=null;
    document.getElementById('autoBtn').textContent='è‡ªå‹•å®Ÿè¡Œ';
    document.getElementById('autoBtn').style.background='var(--accent2)';
  } else {
    document.getElementById('autoBtn').textContent='åœæ­¢';
    document.getElementById('autoBtn').style.background='var(--accent3)';
    gdAuto=setInterval(()=>{
      stepGD();
      if(Math.abs(gdL(gdW))<0.0001){
        clearInterval(gdAuto); gdAuto=null;
        document.getElementById('autoBtn').textContent='å®Œäº†ï¼';
        document.getElementById('autoBtn').style.background='var(--accent)';
      }
    }, 120);
  }
}

// ===== Init =====
window.addEventListener('resize', resizeCanvases);

// Init visual page when navigated to
const observer = new MutationObserver(() => {
  const vp = document.getElementById('page-visual');
  if (vp && vp.classList.contains('active')) {
    setTimeout(resizeCanvases, 50);
  }
});
observer.observe(document.getElementById('page-visual'), { attributes: true, attributeFilter: ['class'] });

// Initial nav setup
document.querySelectorAll('.nav-item').forEach(n => {
  n.addEventListener('click', () => {
    document.querySelectorAll('.nav-item').forEach(m => m.classList.remove('active'));
    n.classList.add('active');
  });
});
</script>
</body>
</html>
